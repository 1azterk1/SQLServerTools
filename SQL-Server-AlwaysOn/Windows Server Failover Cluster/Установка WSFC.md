# Установка отказоустойчивого кластера Windows

## Установка из диспетчера серверов

Для начала необходимо добавить компоненты кластера на машину с Windows Server через "Диспетчер серверов".

![Добавление компонентов кластера](/media/1. Установка WSFC/1. Добавление компонентов.PNG)

Перед нами появится мастер добавления ролей и компонентов.

![Мастер добавления ролей и компонентов](/media/2. Начало работы мастера.PNG)

В нашем случае выбираем "Установка ролей и компонентов", т.к. все настройки выполняем на текущем сервере.

![Выбор типа установки](/media/3. Выбор типа установки.PNG)

Далее на шаге выбора целевого сервера оставляем все как есть.

![Выбор целевого сервера](/media/4. Выбор целевого сервера.PNG)

После этого оказываемся на этапе выбора ролей сервера. В нашем примере здесь также ничего менять не нужно.

![Выбор ролей](/media/5. Выбор ролей сервера.PNG)

А вот на следующем этапе выбора компонентов необходимо указать установку для "Отказоустойчивая кластеризация".

![Выбор компонентов](/media/6. Выбор компонентов.PNG)

А после подтвердить установку связанных компонентов. Кстати, устанавливать средства управления кластером на каждый узел нет необходимости, можно это сделать только там, откуда планируется кластером управлять.

![Подтверждение установки компонентов](/media/7. Установка связанных компонентов.PNG)

Мы в одном шаге от начала установки. Если все правильно, то подтверждаем изменения.

![Подтверждение изменения](/media/8. Подтверждение изменений.PNG)

Ждем некоторое время, пока процесс установки не будет завершен.

![Процесс установки](/media/9. Применение изменений.PNG)

... и получаем установленные компоненты кластеризации на сервере. При желании предопределенную конфигурацию установки кластера можно сохранить в файл и после использовать для развертывания на других серверах.

```PowerShell
# Параметр "ConfigurationFilePath" определяем путь к файлу 
# конфигурации развертывания, который мы сохранили по завершению
# установки компонентов кластера
Install-WindowsFeature -ComputerName $s -ConfigurationFilePath $f
```

![Завершение установки](/media/10. Установка завершена.PNG)

После выполненных изменений необходимо перезапустить сервер.

![Необходим перезапуск](/media/11. Необходим перезапуск.PNG)

## Установка с помощью PowerShell

Установка отказоустойчивого кластера с помощью средств PowerShell выполняется куда проще, чем через интерфейс.

```PowerShell
Install-WindowsFeature -Name Failover-Clustering -IncludeAllSubFeature
```

Если есть необходимость, то также можно установить средства управления кластером.

```PowerShell
Install-WindowsFeature -Name RSAT-Clustering -IncludeAllSubFeature
```

Процесс установки обоих компонентов будет следующим:

1. Запускаем команду.

![Запускаем команду установки кластера](\media\1. Установка WSFC\PowerShell\0. PS. Команда установки.PNG)

2. Ждем.

![Ждем завершение установки кластера](\media\1. Установка WSFC\PowerShell\1. PS. Процесс установки.PNG)

3. Радуемся.

![Установка кластера завершена](\media\PowerShell\2. PS. Установка завершена.PNG)

Тоже самое и для компоненты управления кластером.

1. Раз.

![Запускаем команду установки кластера](\media\1. Установка WSFC\PowerShell\3. PS. Установка средств управления кластером.PNG)

2. Два.

![Ждем завершение установки кластера](\media\1. Установка WSFC\PowerShell\4. PS. Процесс установки средств управления кластером.PNG)

3. Три.

![Установка кластера завершена](\media\PowerShell\5. PS. Установка средств управления завершена.PNG)

